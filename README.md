**# 防木马程序**

**什么是木马**
---------

木马(Trojan),也称木马病毒，是指通过特定的程序(木马程序)来控制另一台计算机。木马通常有两个可执行程序：一个是控制端，另一个是被控制端。木马”程序是目前比较流行的病毒文件，与一般的病毒不同，它不会自我繁殖，也并不“刻意”地去感染其他文件，它通过将自身伪装吸引用户下载执行，向施种木马者提供打开被种主机的门户，使施种者可以任意毁坏、窃取被种者的文件，甚至远程操控被种主机。木马病毒的产生严重危害着现代网络的安全运行。

.木马也称木马病毒 是指通过特定的程序来控制另一台计算机

---

 1. 首先准备好我们需要的依赖库,python hook和pythoncom。    下载安装python hook，下载安装pythoncom模块；
 2. Python keylogger键盘记录的功能的实现主要利用了pythoncom及pythonhook，然后就是对windows
    API的各种调用。
 3. 创建并注册hook管理器，注册hook并执行


----------
**如何创建并注册hook管理器**
进程创建是一件相当复杂的事情-它包含相当多的工作(如果你不相信我，可以反汇编CreateProcess()，这样你就会亲眼看到这点)。为了启动一个进程，可以使用下列步骤：

 1. 可执行文件必须被以FILE_EXECUTE存取方式打开。
    
    　
 2. 可执行映像必须被装载进RAM。

    
    　

 1. 必须建立进程执行对象(EPROCESS，KPROCESS和PEB结构)。

    　

 1. 必须为新建进程分配地址空间。

    
    　

 1. 必须建立进程的主线程的线程执行对象(ETHREAD，KTHREAD和TEBstructures)。

    
    　

 1. 必须为主线程分配堆栈。

    
    　

 1. 必须建立进程的主线程的执行上下文。

    
    　

 1. 必须通知Win32子系统有关该新进程的创建情况。

